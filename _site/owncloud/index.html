<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Creating your own cloud using Fedora and ownCloud &#8211; Carlos Spitzer's Blog</title>
<meta name="description" content="
  
    Overview
  


  



">
<meta name="keywords" content="ownlcoud, storage, cloud, linux">

  

<!-- Twitter Cards -->
<meta name="twitter:title" content="Creating your own cloud using Fedora and ownCloud">
<meta name="twitter:description" content="
  
    Overview
  


  



">
<meta name="twitter:site" content="@lestrade84">
<meta name="twitter:creator" content="@lestrade84">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="/images/owncloud-banner.jpg">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Creating your own cloud using Fedora and ownCloud">
<meta property="og:description" content="
  
    Overview
  


  



">
<meta property="og:url" content="/owncloud/">
<meta property="og:site_name" content="Carlos Spitzer's Blog">





<link rel="canonical" href="/owncloud/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Carlos Spitzer's Blog Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="/assets/js/vendor/html5shiv.min.js"></script>
	<script src="/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="/">Carlos Spitzer's Blog</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				    
				        
				    
				    <li><a href="/posts/" >Posts</a></li>
				
				    
				        
				    
				    <li><a href="/about/" >About</a></li>
				
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->


  <div class="image-wrap">
  <img src=
    
      "/images/owncloud-banner.jpg"
    
  alt="Creating your own cloud using Fedora and ownCloud feature image">
  
  </div><!-- /.image-wrap -->


<div id="main" role="main">
  <div class="article-author-side">
    
  

<div itemscope itemtype="http://schema.org/Person">


	<img src="/images/bio-photo-2.jpg" class="bio-photo" alt="Carlos Spitzer bio photo">


  <h3 itemprop="name">Carlos Spitzer</h3>
  <p>Senior Consultant at Red Hat</p>
  <a href="mailto:me@carlos-spitzer.com" class="author-social" target="_blank"><i class="fa fa-fw fa-envelope-square"></i> Email</a>
  <a href="http://twitter.com/lestrade84" class="author-social" target="_blank"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a>
  
  <a href="http://plus.google.com/+CarlosSpitzerLopez" class="author-social" target="_blank"><i class="fa fa-fw fa-google-plus-square"></i> Google+</a>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
</div>
  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="/owncloud/" rel="bookmark" title="Creating your own cloud using Fedora and ownCloud">Creating your own cloud using Fedora and ownCloud</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <section id="table-of-contents" class="toc">
  <header>
    <h3>Overview</h3>
  </header>
<div id="drawer">
<ul id="markdown-toc">
  <li><a href="#what-is-owncloud" id="markdown-toc-what-is-owncloud">What is ownCloud</a></li>
  <li><a href="#installation-and-configuration" id="markdown-toc-installation-and-configuration">Installation and configuration</a>    <ul>
      <li><a href="#installing-owncloud-7" id="markdown-toc-installing-owncloud-7"> Installing ownCloud 7</a></li>
      <li><a href="#configuring-and-managing-owncloud" id="markdown-toc-configuring-and-managing-owncloud"> Configuring and managing ownCloud</a>        <ul>
          <li><a href="#user-management" id="markdown-toc-user-management">User management</a></li>
          <li><a href="#use-your-external-storage-to-store-data-instead-of-internal-hard-disk" id="markdown-toc-use-your-external-storage-to-store-data-instead-of-internal-hard-disk">Use your external storage to store data (instead of internal hard disk)</a></li>
          <li><a href="#smartphone-and-pc-client-integration-or-how-to-explain-to-your-users-how-to-manage-their-owncloud-services" id="markdown-toc-smartphone-and-pc-client-integration-or-how-to-explain-to-your-users-how-to-manage-their-owncloud-services">Smartphone and PC client integration or “How to explain to your users how to manage their ownCloud services”</a></li>
        </ul>
      </li>
      <li><a href="#backup-your-platform" id="markdown-toc-backup-your-platform">Backup your platform</a></li>
    </ul>
  </li>
</ul>

  </div>
</section>
<!-- /#table-of-contents -->

<p>A few weeks ago I was wondering what additional service I could provide to my family using my Intel NUC D34010WYK in order to centralize cloud storage and avoid using commercial cloud-based solutions: Google Drive, OneDrive, Dropbox…
Every one is expensive and I’m not really sure if my personal data could not be analyzed by “men in black”, you know. Also, if I can manage my own cloud service I could provide storage, contact management, online file edition, centralized calendar, platform user management and a lot more storage space available (as many GiB as my USB 3.0 external disk has available). Moreover, all of this for free and using OpenSource technologies.</p>

<p>What do I mean about “OpenSource Infrastructure Cloud Storage” solution? OK, it simple: a piece of OpenSource software that you can install on your computer providing cloud storage management. The software is entirely administred by you, and you are the only responsible for its availability.
<br /></p>

<h2 id="what-is-owncloud">What is ownCloud</h2>
<p>The best way to know the features of ownCloud 7 is to review the official video-review:</p>
<iframe width="560" height="315" src="http://www.youtube.com/embed/xA3tfBTvH0c" frameborder="0"></iframe>
<p><br /></p>

<p>In this post I’m going to explain how to install and configure your ownCloud infrastructure, providing the following services to any user that could want to use your platform (for example, your family):
* 10 GiB free space for every user account (expandable if you want).
* Centralize contacts and calendar, providing smartphone and cloud integration.
* Online “open format” files edition (odt, odp, ods).
Remember, all of this for free.
<br /></p>

<h2 id="installation-and-configuration">Installation and configuration</h2>

<h3 id="installing-owncloud-7"> Installing ownCloud 7</h3>
<p>I suggest to follow the <a href="http://doc.owncloud.org/server/7.0/admin_manual/" target="_blank">ownCloud Administration Guide</a> to understand the installation &amp; configuration steps.</p>

<blockquote>
  <p>I’m going to explain how to install ownCloud on Fedora 20. For other OS you can follow similar steps, but you should refer to official ownCloud Administration Guide.</p>
</blockquote>

<p>First, you need to create the repository in order to receive future updates:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nb">cd</span> /etc/yum.repos.d/
wget http://download.opensuse.org/repositories/isv:ownCloud:community/Fedora_20/isv:ownCloud:community.repo</code></pre></div>

<blockquote>
  <p>At the time I’m writing this post, ownCloud needs to have SElinux disabled in order to work properly. Please, be aware if you want to preserve your current SElinux activated, you may find some troubles during installation or configuration phase.</p>
</blockquote>

<p>Then, install it:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash">yum install owncloud</code></pre></div>

<p>Now, we can follow the <a href="http://doc.owncloud.org/server/7.0/admin_manual/installation/installation_wizard.html" target="_blank">Installation Wizard</a> to assist us during this phase.</p>

<p>If you access to http://&lt;your_hostname&gt;/owncloudyou and press “Advanced” dropdown menu, you may see the followin screen:</p>
<figure><img src="/images/owncloud-pic1.jpg" /></figure>

<blockquote>
  <p>If you want to use HTTPs, please, follow this post in order to create SSL certificates and configure the Apache service to use them.</p>
</blockquote>

<p>First you can customize the local Data forlder to use. I suggest you to keep this unchanged and then redirect local user folders to your external hard disk or NAS using symbolic links.
Then, you must select the administrator username and password and which database provided you prefer to use:
* Internal SQLite database: for small/medium purposes.
* MySQL local or external database: for medium/high workloads. If you choose this one, you must provide the mySQL connection settings in order to finish the installation.</p>

<p>In my case, I use SQLite because I’m going to serve to no more than 5-6 users and my Intel NUC is not a powerfull machine to run MySQL, PLEX media server and bit-torrent client at the same time :-)</p>

<p>Once you’ve entered all settings, press “Finish Setup” (ownCloud will set up your cloud according to the given settings). When its finished, it will log you in as administrative user and present the “Welcome to ownCloud” screen.</p>

<blockquote>
  <p>If you found the following error message when you access the Welcome page:
“Your web server is not yet properly setup to allow files synchronization because the WebDAV interface seems to be broken. Please double check the installation guides.”
Please refer to this <a href="http://forum.owncloud.org/viewtopic.php?f=17&amp;t=7536" target="_blank">link</a> in order to fix it.
<br /></p>
</blockquote>

<h3 id="configuring-and-managing-owncloud"> Configuring and managing ownCloud</h3>
<p>Now you have installed the ownCloud platform, you should refer to the Configuration and Management documentation in order to learn and understand how many options are available for you and your purposes.</p>

<p>Here, I’m going to explain how to create one “test” account, give it 10 GiB of disk quota and how to centralize contacts and calendar management using a smartphone (Android, iOS, etc..).
<br /></p>

<h4 id="user-management">User management</h4>
<p>A user represents an account of the ownCloud installation. The main fields for this entity are the following:
* Login name (Username): This is the unique ID of a ownCloud user (e.g. test, jon.doe).
* Full Name: This is the name that is used all over the user interface to identify the user i.e. when sharing data or sending mails. If no display name is set, it defaults to the login name.
* Password: This is the password the user uses to login to ownCloud.
* Groups: This is a list of security groups the user is assigned to. By default the user is not member of any user group.
* Group Admin: This is a list of security groups the user has administration privileges for. By default the user is not registered as group admin for any user group.
* Quota: This is the maximum disk space that may be used by the user. If the user reaches this limit he/she is not able to upload or sync further data. The storage quota is specified in the format Number Unit (e.g. 100 B (byte), 50 KB (kilobyte), 20 MB (megabyte), 5 GB (gigabyte)). If no unit is given, the number is interpreted as bytes.</p>
<figure><img src="/images/owncloud-pic2.jpg" /></figure>

<p>To create a new user account, follow these steps:
1. Enter the new user’s Login Name and its initial Password in the appropriate fields (I create a ‘test’ user).
2. (Optional) Select the Groups to which you want to assign the new user.
3. Click Create.
4. (Optional) Edit additional user settings. To set other user settings, such as setting a display name or limiting the user’s storage, please, refer to this <a href="http://doc.owncloud.org/server/7.0/admin_manual/configuration/configuration_users.html" target="_blank">link</a>. Created users will have the storage specified on Default Storage setting on the same page (located right-below the screen, on the gear icon). You can change it, for example to 10 GiB.
<br /></p>

<h4 id="use-your-external-storage-to-store-data-instead-of-internal-hard-disk">Use your external storage to store data (instead of internal hard disk)</h4>
<p>It’s recommended to use external storage (usb 3.0 or NAS) to store your data (and provide more available space for your users). To use it, the easiest way is to create a symbolic link to point to the user folder located on your external disk or NAS.</p>

<p>But first, after create the new user ‘test’, if you open a shell session on your machine, you will see a new folder has been created:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">[</span>root@home<span class="o">]</span><span class="c"># ll /var/www/html/owncloud/data</span>
...
-rwxrwx--- <span class="m">1</span> apache apache         <span class="m">0</span> Aug <span class="m">11</span> 23:08 index.html
-rwxrwx--- <span class="m">1</span> apache apache <span class="m">114422784</span> Aug <span class="m">24</span> 11:50 owncloud.db
-rw-r----- <span class="m">1</span> apache apache   <span class="m">3715824</span> Aug <span class="m">23</span> 17:56 owncloud.log
lrwxrwxrwx <span class="m">1</span> apache apache        <span class="m">29</span> Aug <span class="m">12</span> 12:40 <span class="nb">test</span></code></pre></div>

<p>If we want to redirect the user data to an external storage (usb hard disk or NAS), first we must sync all info stored in the owncloud user folder to the new one on external storage (in my case, mounted on /media/MEDIA/ownCloud directory):</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">[</span>root@home<span class="o">]</span><span class="c"># mkdir /media/MEDIA/ownCloud/test</span>
<span class="o">[</span>root@home<span class="o">]</span><span class="c"># rsync -Pav /var/www/html/owncloud/data/test/* /media/MEDIA/ownCloud/test/</span>
<span class="o">[</span>root@home<span class="o">]</span><span class="c"># rm -rf /var/www/html/owncloud/data/test</span></code></pre></div>

<p>And then, we can create a symbolic link to this new folder:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">[</span>root@home<span class="o">]</span><span class="c"># ln -s /media/MEDIA/ownCloud/test /var/www/html/owncloud/data/test</span>
<span class="o">[</span>root@home<span class="o">]</span><span class="c"># ll /var/www/html/owncloud/data</span>
total 115384
-rwxrwx--- <span class="m">1</span> apache apache         <span class="m">0</span> Aug <span class="m">11</span> 23:08 index.html
-rwxrwx--- <span class="m">1</span> apache apache <span class="m">114422784</span> Aug <span class="m">24</span> 11:50 owncloud.db
-rw-r----- <span class="m">1</span> apache apache   <span class="m">3715824</span> Aug <span class="m">23</span> 17:56 owncloud.log
lrwxrwxrwx <span class="m">1</span> apache apache        <span class="m">29</span> Aug <span class="m">12</span> 12:40 <span class="nb">test</span> -&gt; /media/MEDIA/ownCloud/test</code></pre></div>

<p>Now, you have the current user data stored using the external device.
<br /></p>

<h4 id="smartphone-and-pc-client-integration-or-how-to-explain-to-your-users-how-to-manage-their-owncloud-services">Smartphone and PC client integration or “How to explain to your users how to manage their ownCloud services”</h4>
<p>This is the hardest part of the job: explain to your users (family and potential non-technical users) how to manage this new account and services. OwnCloud has a very good <a href="http://doc.owncloud.org/server/7.0/user_manual/" target="_blank">start-point guide</a> that you can share with your users. Instead of write how to do it, it’s better to follow the latest updated ownCloud guide. I wish you luck!! XD
<br /></p>

<h3 id="backup-your-platform">Backup your platform</h3>
<p>In order to make a daily/weekly/monthly backup of your ownCloud configuration, you can use the following script and configure cron to call it using your desired frequency:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="o">[</span>root@home:~<span class="o">]</span><span class="c"># ll backup.sh </span>
-rwx------ <span class="m">1</span> root root <span class="m">1095</span> Aug <span class="m">13</span> 19:12 backup.sh</code></pre></div>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#!/bin/bash</span>
 
<span class="nv">PATH</span><span class="o">=</span><span class="s2">&quot;/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin&quot;</span>
<span class="nb">cd</span> /media/MEDIA/ownCloud/lestrade84/files/Proyectos/OpenShift
 
<span class="c"># Backup ownCloud site</span>
<span class="nb">cd</span> /media/MEDIA/ownCloud/admin/files/ownCloud
tar -zcvf ./owncloud-dirbkp_<span class="k">$(</span>date +<span class="s2">&quot;%Y%m%d&quot;</span><span class="k">)</span>.tar.gz  /var/www/html/owncloud
cp owncloud-dirbkp_<span class="k">$(</span>date +<span class="s2">&quot;%Y%m%d&quot;</span><span class="k">)</span>.tar.gz /root/backup/ownCloud/
sqlite3 /var/www/html/owncloud/data/owncloud.db .dump &gt; ./owncloud-sqlbkp_<span class="k">$(</span>date +<span class="s2">&quot;%Y%m%d&quot;</span><span class="k">)</span>.bak
cp owncloud-sqlbkp_<span class="k">$(</span>date +<span class="s2">&quot;%Y%m%d&quot;</span><span class="k">)</span>.bak /root/backup/ownCloud/</code></pre></div>

<p>I call it every sunday using cron, so I save a weekly-backup copy for configuration and database dump on my external device and intel-nuc’s local directory /root/backup. Also, I use Fedora 20 <a href="http://fedoraproject.org/wiki/Features/OwnCloud" target="_blank">ownCloud client</a> integration, so every week the client automatically download the latest backup file generated (so I have 3 different copies of this data for security and availability reasons).</p>

<p>You can use the scheme which best fit your purposes.</p>

      <hr />
      <footer role="contentinfo">
        <div class="social-share">
  <h4>Share on</h4>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?text=/owncloud/" class="twitter" title="Share on Twitter"><i class="fa fa-twitter"></i><span> Twitter</span></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=/owncloud/" class="facebook" title="Share on Facebook"><i class="fa fa-facebook"></i><span> Facebook</span></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=/owncloud/" class="google-plus" title="Share on Google Plus"><i class="fa fa-google-plus"></i><span> Google+</span></a>
    </li>
  </ul>
</div><!-- /.social-share -->
        <p class="byline"><strong>Creating your own cloud using Fedora and ownCloud</strong> was published on <time datetime="2014-08-24T00:00:00+02:00">August 24, 2014</time> and last modified on <time datetime="2015-03-08">March 08, 2015</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="/posts/">View all posts</a>)</small></h4>
    <ul>
    
      <li><a href="/elk/" title="Improving log-analysis capabilities with logstash + elasticsearch + kibana">Improving log-analysis capabilities with logstash + elasticsearch + kibana</a></li>
    
      <li><a href="/motog/" title="How to flash Motorola Moto G (factory image)">How to flash Motorola Moto G (factory image)</a></li>
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  <footer>
    

<span>&copy; 2015 Carlos Spitzer. <br> Hosted on <a href="http://www.openshift.com" rel="nofollow" target="_blank">OpenShift</a> and powered by <a href="http://jekyllrb.com" rel="nofollow" target="_blank">Jekyll</a> using the <a href="http://mademistakes.com/minimal-mistakes/" rel="nofollow" target="_blank">Minimal Mistakes</a> theme.</br></span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>


  
	        

</body>
</html>